# -------------------------------------------------------------------------
# default/restmap.conf
#
# REST endpoint mappings for Dragos OT Security for Splunk App
#
# This file defines:
# - Modular input registration
# - Setup handler
# - Validation handler
#
# Data collection is executed by the modular input framework and does not
# require custom REST collection endpoints.
# -------------------------------------------------------------------------


# -------------------------------------------------------------------------
# Modular input REST registration
#
# Required for Splunk to discover and execute dragos_input.py
# -------------------------------------------------------------------------
[script:dragos_ot_security]
interval = 0
script = dragos_input.py
sourcetype = dragos:json
passAuth = true


# -------------------------------------------------------------------------
# App setup handler
#
# Used by setup.xml to validate connectivity and store configuration
# -------------------------------------------------------------------------
[admin:setup]
match = /servicesNS/nobody/dragos_ot_security_for_splunk/setup
members = dragos_setup

[dragos_setup]
handler = dragos_setup_handler.setup_handler
requireAuthentication = true
capability = admin_all_objects


# -------------------------------------------------------------------------
# Modular input validation handler
#
# Invoked automatically by Splunk when validating input configuration
# -------------------------------------------------------------------------
[admin:validation]
match = /servicesNS/nobody/dragos_ot_security_for_splunk/validation
members = dragos_validation

[dragos_validation]
handler = dragos_validation.validate_input
requireAuthentication = true
capability = admin_all_objects
