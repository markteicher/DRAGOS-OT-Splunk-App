# -------------------------------------------------------------------------
# default/alert_actions.conf
#
# Dragos OT Security for Splunk App
#
# Purpose:
# - Define custom alert actions for Dragos detections and notifications
# - Support external notifications and integrations
# - No mutation of Dragos data
#
# Design rules:
# - Alert actions are OPTIONAL
# - Disabled by default
# - Read-only use of search results
# - Safe for Splunk Cloud and AppInspect
# -------------------------------------------------------------------------

###############################################################################
# EMAIL ALERT ACTION
###############################################################################

[dragos_email_alert]
is_custom = 1
label = Dragos Email Alert
description = Send email notification for Dragos alerts and notifications
icon_path = appIcon.png
payload_format = json
disabled = 0

param.to =
param.cc =
param.subject = [Dragos Alert] $name$
param.message = Dragos Alert Triggered\n\nAlert Name: $name$\nTrigger Time: $trigger_time$\nResults Matched: $result.count$\n\nDetails:\n$result._raw$
param.include_results = 1
param.include_link = 1
param.priority = normal

###############################################################################
# WEBHOOK ALERT ACTION
###############################################################################

[dragos_webhook_alert]
is_custom = 1
label = Dragos Webhook Alert
description = Send Dragos alert payload to external systems (SOAR, Slack, Teams, SIEM)
icon_path = appIcon.png
payload_format = json
disabled = 0

param.webhook_url =
param.method = POST
param.content_type = application/json
param.include_results = 1
param.custom_headers =
param.verify_ssl = 1
param.timeout = 30

param.payload_template = {
  "alert_name": "$name$",
  "trigger_time": "$trigger_time$",
  "results_count": "$result.count$",
  "search_name": "$search_name$",
  "app": "$app$",
  "owner": "$owner$",
  "results_link": "$results_link$",
  "notification_id": "$result.id$",
  "severity": "$result.severity$",
  "state": "$result.state$",
  "type": "$result.type$",
  "source": "Dragos OT Security"
}

###############################################################################
# SCRIPT ALERT ACTION
###############################################################################

[dragos_script_alert]
is_custom = 1
label = Dragos Script Alert
description = Execute a custom script for Dragos alerts (ticketing, SOAR, automation)
icon_path = appIcon.png
payload_format = json
disabled = 0

param.script_name = dragos_alert_script.py
param.script_args =
param.pass_payload = 1

###############################################################################
# SERVICENOW INTEGRATION
###############################################################################

[dragos_snow_alert]
is_custom = 1
label = Dragos ServiceNow Alert
description = Create ServiceNow incidents for critical Dragos alerts
icon_path = appIcon.png
payload_format = json
disabled = 0

param.snow_url =
param.snow_user =
param.snow_password =
param.incident_category = Security
param.incident_subcategory = OT Security
param.incident_priority = 3
param.incident_short_description = [Dragos] Alert: $name$
param.incident_description = Dragos alert triggered.\n\nAlert: $name$\nSeverity: $result.severity$\nState: $result.state$\nType: $result.type$\n\nRaw Event:\n$result._raw$

###############################################################################
# PAGERDUTY INTEGRATION
###############################################################################

[dragos_pagerduty_alert]
is_custom = 1
label = Dragos PagerDuty Alert
description = Trigger PagerDuty incidents for high-impact Dragos alerts
icon_path = appIcon.png
payload_format = json
disabled = 0

param.routing_key =
param.severity = error
param.dedup_key = dragos-$result.id$
param.event_action = trigger
param.summary = Dragos Alert: $name$
param.source = Splunk Dragos App
param.component = $result.type$
param.group = ot-security
param.class = dragos-alert

###############################################################################
# END OF FILE
###############################################################################
