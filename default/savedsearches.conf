# -------------------------------------------------------------------------
# default/savedsearches.conf
#
# Dragos OT Security for Splunk App
#
# Location:
#   $SPLUNK_HOME/etc/apps/dragos_ot_security_for_splunk/default/savedsearches.conf
#
# Purpose:
# - Define read-only reports, summaries, and dashboard backing searches
# - Provide reusable, named searches for Dragos data domains
# - Support dashboards without duplicating SPL
#
# Design rules:
# - SEARCH ONLY (no outputlookup, collect, sendemail, etc.)
# - No alerts enabled by default
# - No scheduled execution unless explicitly required
# - Index and sourcetype scoping via macros
#
# -------------------------------------------------------------------------

###############################################################################
# Overview / Executive summaries
###############################################################################

[Dragos - Notification Summary by Severity]
search = `dragos_notifications` | stats count by severity
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Dragos - Notification Trend (24h)]
search = `dragos_notifications` | timechart span=1h count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Asset inventory
###############################################################################

[Dragos - Asset Inventory]
search = `dragos_assets` | stats latest(*) as * by id
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Dragos - Assets by OS]
search = `dragos_assets` | stats count by os.family, os.name, os.version
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Vulnerabilities
###############################################################################

[Dragos - Vulnerabilities (All)]
search = `dragos_vulnerabilities` | sort - lastObservedTime
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

[Dragos - Vulnerabilities by Severity]
search = `dragos_vulnerabilities` | stats count by risk
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Protocols & communications
###############################################################################

[Dragos - Protocol Activity]
search = `dragos_assets` | spath | mvexpand protocols | spath input=protocols
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Dragos - Protocols by Category]
search = `dragos_assets` | spath | mvexpand protocols | spath input=protocols | stats count by protocols.category
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Users & roles
###############################################################################

[Dragos - Users]
search = `dragos_users` | sort name
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

[Dragos - Users by Role]
search = `dragos_users` | mvexpand roles | stats count by roles
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Notifications
###############################################################################

[Dragos - Notifications (All)]
search = `dragos_notifications` | sort - updatedAt
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Audit & operational logging
###############################################################################

[Dragos - Audit Events]
search = `dragos_audit` | sort - _time
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Dragos - Error Events]
search = `dragos_logs_error` | sort - _time
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# System & platform metadata
###############################################################################

[Dragos - Platform Version]
search = `dragos_version` | stats latest(version) as version
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

[Dragos - System Health]
search = `dragos_system_health` | sort - _time
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# END OF FILE
###############################################################################
