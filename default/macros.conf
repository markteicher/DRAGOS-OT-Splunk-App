# -------------------------------------------------------------------------
# macros.conf
#
# Dragos OT Security for Splunk App
#
# Purpose:
# - Provide reusable, read-only SPL macros for Dragos datasets
# - Standardize searches across dashboards, reports, and saved searches
# - Avoid duplicated SPL logic
# - Preserve raw event integrity (no eval-based mutation of _raw)
#
# Design rules:
# - Macros are SEARCH-TIME ONLY
# - No macros perform writes, lookups, or enrichment
# - Macros must be safe for Splunk Cloud
# - Macros must not assume a specific index unless explicitly required
#
# Naming convention:
#   dragos_<domain>_<purpose>
#
# -------------------------------------------------------------------------

###############################################################################
# Base macros
###############################################################################

[dragos_index]
definition = index=dragos
iseval = 0

[dragos_all_events]
definition = index=dragos sourcetype=dragos:*
iseval = 0

###############################################################################
# Core platform domains
###############################################################################

[dragos_assets]
definition = index=dragos sourcetype=dragos:assets
iseval = 0

[dragos_notifications]
definition = index=dragos sourcetype=dragos:notifications
iseval = 0

[dragos_vulnerabilities]
definition = index=dragos sourcetype=dragos:vulnerabilities
iseval = 0

[dragos_alerts]
definition = index=dragos sourcetype=dragos:alerts
iseval = 0

[dragos_indicators]
definition = index=dragos sourcetype=dragos:indicators
iseval = 0

[dragos_threat_intel]
definition = index=dragos sourcetype=dragos:threat_intel
iseval = 0

###############################################################################
# Protocols & communications
###############################################################################

[dragos_protocols]
definition = index=dragos sourcetype=dragos:assets
iseval = 0

###############################################################################
# Users and Roles
###############################################################################

[dragos_users]
definition = index=dragos sourcetype=dragos:users
iseval = 0

[dragos_roles]
definition = index=dragos sourcetype=dragos:roles
iseval = 0

[dragos_permissions]
definition = index=dragos sourcetype=dragos:permissions
iseval = 0

###############################################################################
# Administrative & operational data
###############################################################################

[dragos_audit_logs]
definition = index=dragos sourcetype=dragos:audit
iseval = 0

[dragos_error_logs]
definition = index=dragos sourcetype=dragos:error
iseval = 0

[dragos_system_health]
definition = index=dragos sourcetype=dragos:system:health
iseval = 0

[dragos_version]
definition = index=dragos sourcetype=dragos:version
iseval = 0

###############################################################################
# Utility macros (safe helpers)
###############################################################################

[dragos_timechart_by_day]
definition = timechart span=1d count
iseval = 0

[dragos_latest_by_field(1)]
definition = stats latest(*) as * by $field$
iseval = 0

###############################################################################
# END OF FILE
###############################################################################
