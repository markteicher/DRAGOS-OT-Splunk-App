<!--
=============================================================================
 default/data/ui/views/dragos_vulnerabilities.xml
 Dragos OT Security for Splunk App
 Vulnerabilities
=============================================================================

PURPOSE

Displays all vulnerability detections retrieved from the Dragos Platform
using the Dragos REST API endpoint:

  GET /api/v1/vulnerabilities?expand=asset,report

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>Vulnerabilities</label>

  <!-- =============================================================== -->
  <!-- ROW 1: VULNERABILITY DETECTIONS                                 -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Vulnerability Detections</title>
      <table>
        <search>
          <query>
            index=* sourcetype=dragos:vulnerabilities
            | spath
            | table
                id
                state
                severity
                confidence
                firstSeenAt
                lastSeenAt
                count
                asset.id
                asset.name
                asset.type
                asset.vendor
                asset.model
                asset.firmwareVersion
                asset.ipAddress
                asset.macAddress
                asset.site
                asset.zone
                report.id
                report.title
                report.cve
                report.cwe
                report.cvssScore
                report.cvssVector
                report.description
                report.remediation
                report.reference
            | sort - lastSeenAt
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

</dashboard>
