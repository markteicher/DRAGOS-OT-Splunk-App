<!--
=============================================================================
 default/data/ui/views/dragos_web_threat_intel.xml
 Dragos OT Security for Splunk App
 Web Threat Intelligence — Analyst Hub
=============================================================================

PURPOSE

Web threat intelligence hub derived from Dragos indicators.

This view enables pivot-driven investigation into:
- DNS indicators
- URL / Web indicators
- Single-IOC investigation workflows

This view LINKS to drilldown dashboards.


DATA SOURCE

GET /api/v1/indicators
→ sourcetype=dragos:indicators

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>Web Threat Intelligence</label>

  <!-- =============================================================== -->
  <!-- ROW 1: DNS INDICATORS (DRILLDOWN ENTRY)                          -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>DNS Indicators</title>
      <table>
        <search>
          <query>
            index=* sourcetype=dragos:indicators
            | spath
            | where indicator_type="domain" OR indicator_type="dns"
            | stats count as indicator_count
                earliest(first_seen) as first_seen
                latest(last_seen) as last_seen
              by value confidence
            | sort - indicator_count
          </query>
        </search>

        <drilldown>
          <link>
            /app/dragos/dragos_dns_threat_intel_drilldown
            ?form.domain=$row.value$
          </link>
        </drilldown>

        <option name="wrap">false</option>
        <option name="rowNumbers">true</option>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: URL / WEB INDICATORS (DRILLDOWN ENTRY)                    -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>URL & Web Indicators</title>
      <table>
        <search>
          <query>
            index=* sourcetype=dragos:indicators
            | spath
            | where indicator_type="url" OR indicator_type="http" OR indicator_type="https"
            | stats count as indicator_count
                earliest(first_seen) as first_seen
                latest(last_seen) as last_seen
              by value confidence category
            | sort - indicator_count
          </query>
        </search>

        <drilldown>
          <link>
            /app/dragos/dragos_ioc_pivot_drilldown
            ?form.ioc=$row.value$
            &amp;form.type=url
          </link>
        </drilldown>

        <option name="wrap">false</option>
        <option name="rowNumbers">true</option>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 3: ALL IOC PIVOT ENTRY                                      -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>IOC Pivot (IP / Domain / URL)</title>
      <table>
        <search>
          <query>
            index=* sourcetype=dragos:indicators
            | spath
            | stats count as sightings
                earliest(first_seen) as first_seen
                latest(last_seen) as last_seen
              by value indicator_type kill_chain
            | sort - sightings
            | head 50
          </query>
        </search>

        <drilldown>
          <link>
            /app/dragos/dragos_ioc_pivot_drilldown
            ?form.ioc=$row.value$
            &amp;form.type=$row.indicator_type$
          </link>
        </drilldown>

        <option name="wrap">false</option>
        <option name="rowNumbers">true</option>
      </table>
    </panel>
  </row>

</dashboard>
