###############################################################################
# Dragos OT Security – transforms.conf
# Purpose: Field normalization only (NO lookups)
###############################################################################

###############################################################################
# Severity Normalization
###############################################################################
# Normalize inconsistent severity values into a standard field
###############################################################################

[dragos_normalize_severity]
REGEX = (?i)^(critical|high|medium|low|info)$
FORMAT = severity::$1
DEST_KEY = _meta


###############################################################################
# Protocol Normalization
###############################################################################
# Normalize protocol casing (e.g. modbus → Modbus)
###############################################################################

[dragos_normalize_protocol]
REGEX = (?i)^(modbus|dnp3|ethernet/ip|opc|s7)$
FORMAT = protocol::$1
DEST_KEY = _meta


###############################################################################
# Threat Actor Field Alias
###############################################################################
# Ensure consistent naming across events
###############################################################################

[dragos_threat_actor_alias]
REGEX = .+
FORMAT = threat_actor::$0
DEST_KEY = _meta


###############################################################################
# Asset Identifier Normalization
###############################################################################
# Ensure asset_id exists consistently
###############################################################################

[dragos_asset_id_normalize]
REGEX = .+
FORMAT = asset_id::$0
DEST_KEY = _meta
